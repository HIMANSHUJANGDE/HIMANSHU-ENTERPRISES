<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>A4 Multi-Photo Print Direct</title>
<style>
body { margin:0; font-family:Arial; }
@page { size:A4 portrait; margin:8mm; }
#controls { padding:15px; background:#f2f2f2; border-bottom:1px solid #ccc; }
#previewList { margin-top:15px; display:flex; flex-direction:column; gap:12px; }
.previewItem { display:flex; align-items:center; gap:12px; padding:8px; background:#fff; border:1px solid #ccc; }
.previewItem img { width:70px; border:1px solid #aaa; }

#photoArea { display:flex; flex-wrap:wrap; gap:4mm; padding:8mm; }
.photoBox { width:35mm; height:25mm; border:0.5mm solid #000; display:flex; justify-content:center; align-items:center; overflow:hidden; }
.photoBox img { width:100%; }

@media print { #controls,#previewList{display:none !important;} #photoArea{gap:3mm;padding:0;} }
</style>
</head>
<body>

<div id="controls">
<h3>A4 Multi-Photo Print (Direct)</h3>
<input type="file" id="fileInput" accept="image/*" multiple onchange="loadImages()">
<p>Upload multiple images → Set PCS → Generate → Print</p>
<div id="previewList"></div>
<button onclick="generate()">Generate Photos</button>
<button onclick="window.print()">Print</button>
</div>

<div id="photoArea"></div>

<script>
let images = [];

function loadImages() {
    const files = fileInput.files;
    for (let i = 0; i < files.length; i++) {
        let file = files[i];
        let reader = new FileReader();
        reader.onload = e => {
            let id = images.length;
            images.push({ src: e.target.result, pcs: 6 });

            let div = document.createElement("div");
            div.className = "previewItem";
            div.innerHTML = `
                <img src="${e.target.result}">
                <div>
                    PCS: <input type="number" min="1" value="6" onchange="images[${id}].pcs=this.value">
                </div>`;
            previewList.appendChild(div);
        };
        reader.readAsDataURL(file);
    }
    fileInput.value = "";
}

function generate() {
    photoArea.innerHTML = "";
    images.forEach(img => {
        for (let i = 0; i < img.pcs; i++) {
            let box = document.createElement("div");
            box.className = "photoBox";

            let pic = document.createElement("img");
            pic.src = img.src;
            box.appendChild(pic);

            photoArea.appendChild(box);
        }
    });
}
</script>

</body>
</html>
